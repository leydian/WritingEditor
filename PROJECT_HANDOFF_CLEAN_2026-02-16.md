# WritingEditor 정리 인수인계 (Clean) - 2026-02-16

기준 경로: `C:\dlatl\WritingEditor`  
기준 브랜치: `main`  
원격 저장소: `https://github.com/leydian/WritingEditor`  
현재 스크립트 로드: `index.html`에서 `app.js?v=57`

## 1) 현재 상태 한 줄 요약

웹 기반 글쓰기 에디터이며, 인증/동기화/히스토리/포모도로/모바일 미니모드까지 동작하는 상태다.

## 2) 핵심 기능 상태

1. 인증
- 이메일/비밀번호 로그인, 회원가입 지원
- 익명 로그인(`익명으로 시작`) 지원
- 익명 로그인 후 이메일 계정으로 전환(`회원가입`) 지원

2. 탈퇴/로그아웃
- 일반 계정: 탈퇴 전 재로그인 검증 후 탈퇴
- 익명 계정: 로그아웃 시 자동 탈퇴(계정/원격 데이터/로컬 데이터 정리)
- 탈퇴 확인 게이트: 체크박스 + 확인문구 `회원탈퇴` 입력 필수

3. 저장/동기화
- 로컬 상태 키: `we-proto-state-v1`
- 레이아웃 키: `we-layout-prefs-v1`
- 마지막 사용자 키: `we-last-user-id`
- Supabase 설정 키: `we-supabase-config-v1`
- 자동 동기화: 30분 간격
- 수동 동기화 버튼: `지금 동기화`

4. 히스토리
- 전역 `historyEntries` 기반
- 최대 10개 보관
- 검색 및 snapshot 복원 지원

5. 포모도로/오늘 기록
- 집중 완료 시 집중 횟수 증가
- 집중 모드에서만 `focusSecondsByDate` 누적
- 오늘 기록에 집중 시간(`HH:MM:SS`) 표시

6. 모바일 UX (`<=900px`)
- `mobile-mini` 모드 동작
- 문서목록/달력 드로어 토글
- 모바일 툴바 정리 및 분할 버튼 숨김
- 문서목록과 달력은 동시 오픈 방지

## 3) 최근 반영 사항(중요)

1. 모바일 미니모드/드로어 UX가 반영되어 있음.
2. 탈퇴 흐름(일반/익명)과 로컬 데이터 잔존 이슈 수정이 반영되어 있음.
3. `historyByDoc` 잔재 정리 완료:
- 기본 상태에서 `historyByDoc` 필드 제거
- 구버전 상태 로드 시 `historyByDoc` 키 자동 삭제
- 문서/폴더 삭제 시 `historyByDoc` 접근 코드 제거

## 4) 핵심 파일

1. `index.html`
- 인증 게이트, 툴바, 주요 다이얼로그 DOM 정의
- `app.js?v=57` 로드

2. `styles.css`
- 데스크톱/모바일 레이아웃
- 모바일 미니모드 및 드로어 스타일

3. `app.js`
- 상태 관리, 에디터 로직, 히스토리, 포모도로, 인증/동기화
- 모바일 토글 동작 및 탈퇴/전환 플로우

## 5) Supabase 운영 메모

1. 내장 상수 사용:
- URL: `https://rvrysnatyimuilarxfft.supabase.co`
- Anon Key: 코드에 내장된 publishable key 사용

2. 주의:
- 프런트 코드 내 키 완전 비공개는 불가
- RLS/정책으로 접근 통제를 유지해야 함

3. 필수 함수:
- 계정 삭제 RPC: `delete_my_account_rpc_v3`

## 6) 점검 체크리스트

1. 인증
- 이메일 로그인/회원가입
- 익명 시작
- 익명 로그인 후 `회원가입` 전환

2. 탈퇴
- 일반 탈퇴: 재로그인 검증 + 확인문구 게이트
- 익명 로그아웃: 자동 탈퇴 및 데이터 정리

3. 히스토리
- 항목 생성/검색/복원
- 복원 후 히스토리 목록 유지 확인

4. 모바일
- `문서목록`/`달력` 버튼 토글
- 외부 영역 탭 시 드로어 닫힘
- 분할 버튼 모바일 숨김

## 7) 남은 작업 우선순위

1. `DEPLOY.md` 또는 `SUPABASE.md`에 운영 SQL/정책 정식 문서화
2. 커스텀 도메인 반영 완료 후 Supabase `Site URL`/`Redirect URLs` 재확인
3. 실패 케이스(탈퇴/전환/동기화) 사용자 안내 문구 표준화

---

이 문서는 `PROJECT_HANDOFF_2026-02-15_SESSION_UPDATE.md`와 `PROJECT_HANDOFF_2026-02-16.md`를 통합 정리하고, 최신 코드 상태(`historyByDoc` 잔재 제거 포함)를 반영한 기준 문서다.
